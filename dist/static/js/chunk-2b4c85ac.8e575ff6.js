(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2b4c85ac"],{"2b12":function(e,t,o){"use strict";o.r(t);var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"tabs-box"},[o("common-table",{ref:"table",attrs:{headers:e.headers,api:e.getUserListAPI,params:e.params,settings:["setting"]},on:{editRow:e.editRow,deleteRow:e.deleteRow,add:e.add},scopedSlots:e._u([{key:"table-header",fn:function(){return[o("table-search",{attrs:{resettable:"",columns:e.searchColumns},on:{search:e.search},model:{value:e.params,callback:function(t){e.params=t},expression:"params"}})]},proxy:!0}])}),e.visibleDialog?o("edit-dialog",{attrs:{visibleDialog:e.visibleDialog,title:e.title,loading:e.loading},on:{"update:visibleDialog":function(t){e.visibleDialog=t},"update:visible-dialog":function(t){e.visibleDialog=t},save:e.submit},scopedSlots:e._u([{key:"form-content",fn:function(){return[o("div",{staticClass:"account-form"},[o("el-form",{ref:"form",staticStyle:{position:"relative"},attrs:{model:e.form,rules:e.accountRules,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[o("el-input",{staticClass:"medium-width",model:{value:e.form.userName,callback:function(t){e.$set(e.form,"userName",t)},expression:"form.userName"}})],1),o("div",{staticStyle:{position:"absolute",top:"8px",left:"400px",width:"100px"}},["edit"===e.type?o("el-link",{attrs:{underline:!1,type:"primary"},on:{click:function(t){e.showPassword=!e.showPassword}}},[e._v("修改密码")]):e._e()],1),e.showPassword?o("el-form-item",{attrs:{label:"密码",prop:"password"}},[o("el-input",{staticClass:"medium-width",attrs:{"show-password":""},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1):e._e(),e.showPassword?o("el-form-item",{attrs:{label:"确认密码",prop:"checkPassword"}},[o("el-input",{staticClass:"medium-width",attrs:{"show-password":""},model:{value:e.form.checkPassword,callback:function(t){e.$set(e.form,"checkPassword",t)},expression:"form.checkPassword"}})],1):e._e(),o("el-form-item",{attrs:{label:"组织架构",prop:"orgId"}},[o("form-organize",{staticClass:"medium-width",model:{value:e.form.orgId,callback:function(t){e.$set(e.form,"orgId",t)},expression:"form.orgId"}})],1),o("el-form-item",{attrs:{label:"角色权限",prop:"roleIds"}},[o("form-select",{staticClass:"medium-width",attrs:{multiple:"",options:e.options.roles},model:{value:e.form.roleIds,callback:function(t){e.$set(e.form,"roleIds",t)},expression:"form.roleIds"}})],1)],1)],1)]},proxy:!0}],null,!1,64110801)}):e._e()],1)},s=[],a=(o("99af"),o("4160"),o("b0c0"),o("d3b7"),o("25f0"),o("159b"),o("1892")),i=o("ddde"),n=o("6208"),l=o("8604"),c=o("2422"),u="",m=/^(?=.*[a-zA-Z])(?=.*\d)[\S]{8,16}$/,p={userName:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,validator:function(e,t,o){u=t,m.test(t)?o():o(new Error("密码需要8-16位，且至少包含字母和数字，不能有空格"))},trigger:"blur"}],checkPassword:[{required:!0,validator:function(e,t,o){""===t?o(new Error("请再次输入密码")):t!==u?o(new Error("两次输入密码不一致!")):o()},trigger:"blur"}],orgId:[{required:!0,message:"请选择",trigger:"blur"}],roleIds:[{required:!0,message:"请选择",trigger:"blur"}]},d=o("afaa"),f=function(e){return Object(d["a"])({method:"GET",url:"/api-customer/entity/user/queryUserBounds",params:e})},h=function(){return Object(d["a"])({method:"GET",url:"/api-customer/account/web/roles"})},b=function(e){return Object(d["a"])({method:"POST",url:"/api-customer/account/user/userBounds",data:e})},g=function(e){return Object(d["a"])({method:"PUT",url:"/api-customer/account/user/userBounds",data:e})},w=function(e){return Object(d["a"])({method:"DELETE",url:"/api-customer/account/user/userBounds",params:e})},v=function(){return Object(d["a"])({method:"GET",url:"/api-customer/account/user/users"})},y={name:"Account",components:{CommonTable:a["a"],TableSearch:n["a"],EditDialog:i["a"],FormOrganize:l["a"],FormSelect:c["a"]},data:function(){return{getUserListAPI:f,accountRules:p,activeName:"account",visibleDialog:!1,showPassword:!1,loading:!1,type:"add",title:"新增账号",options:{roles:[],account:[]},params:{},searchColumns:[{prop:"userId",label:"用户名",type:"select",options:[]},{prop:"orgId",label:"组织机构",type:"org"},{prop:"roleIds",label:"角色权限",type:"select",options:[]}],headers:[{prop:"index",label:"序号"},{prop:"userName",label:"用户名"},{prop:"orgName",label:"组织机构"},{prop:"roleNames",label:"角色权限",filter:this.filterRolesName},{prop:"action",label:"操作",width:100,fixed:"right"}],form:{}}},created:function(){this.getRoleList(),this.getAccountList()},methods:{getRoleList:function(){var e=this;h().then((function(t){var o=[];t.forEach((function(e){o.push({id:e.id,name:e.name})})),e.options.roles=o,e.searchColumns[2].options=o}))},getAccountList:function(){var e=this;v().then((function(t){e.options.accounts=t||[],e.searchColumns[0].options=t||[]}))},search:function(){this.$refs.table.onQuery()},editRow:function(e){this.type="edit",this.title="编辑账号",this.form=Object.assign({},e),this.showPassword=!1,this.visibleDialog=!0},deleteRow:function(e){var t=this;this.$confirm("确定要删除吗？").then((function(){w({recordId:e.id}).then((function(){t.$message.success("账号删除成功！"),t.$refs.table.refresh(),t.getAccountList()})).catch((function(e){t.$message.error("账号删除失败："+e)}))}))},add:function(){this.type="add",this.title="新增账号",this.form={},this.showPassword=!0,this.visibleDialog=!0},submit:function(){var e=this;this.$refs.form.validate((function(t){if(t){var o="add"===e.type?b:g;e.loading=!0,e.form.manageId=[e.form.orgId],"edit"===e.type&&(e.form.recordId=e.form.id),e.showPassword||(delete e.form.password,delete e.form.checkPassword),o(e.form).then((function(){e.$message.success("".concat(e.title,"成功！")),e.visibleDialog=!1,e.$refs.table.refresh(),e.getAccountList()})).catch((function(t){e.$message.error("".concat(e.title,"失败：").concat(t))})).finally((function(){e.loading=!1}))}}))},filterRolesName:function(e){return e?e.toString():"--"}}},_=y,x=(o("d484"),o("2877")),k=Object(x["a"])(_,r,s,!1,null,"25585752",null);t["default"]=k.exports},6208:function(e,t,o){"use strict";var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"table-search"},[o("div",{directives:[{name:"resize",rawName:"v-resize",value:e.formResize,expression:"formResize"}],ref:"search-form",staticClass:"search-form"},[o("div",{ref:"form-box"},[e._t("default",[o("el-form",{ref:"form",attrs:{model:e.form,inline:!0,"label-width":e.labelWidth}},[e._l(e.columns,(function(t,r){return o("el-form-item",{key:r,attrs:{label:t.label,"label-width":t.labelWidth}},["org"===t.type?o("form-organize",{model:{value:e.form[t.prop],callback:function(o){e.$set(e.form,t.prop,o)},expression:"form[column.prop]"}}):"input"===t.type?o("el-input",e._b({staticClass:"short-width",model:{value:e.form[t.prop],callback:function(o){e.$set(e.form,t.prop,o)},expression:"form[column.prop]"}},"el-input",t.props,!1)):"select"===t.type?o("form-select",e._b({staticClass:"search-select-item",attrs:{options:t.options},model:{value:e.form[t.prop],callback:function(o){e.$set(e.form,t.prop,o)},expression:"form[column.prop]"}},"form-select",t.props,!1)):"date"===t.type||"dateRange"===t.type?o("el-date-picker",e._b({style:{width:"date"===t.type?"215px":""},model:{value:e.form[t.prop],callback:function(o){e.$set(e.form,t.prop,o)},expression:"form[column.prop]"}},"el-date-picker",t.props,!1)):e._t(t.prop,null,{form:e.form})],2)})),e._t("default")],2)])],2)]),o("div",{staticClass:"search-btn"},[e._t("search-btn",[o("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("查 询")]),e.resettable?o("el-button",{on:{click:e.reset}},[e._v("重 置")]):e._e()]),e.showOpen?[!1===e.open?o("el-button",{attrs:{type:"text"},on:{click:function(t){e.open=!0}}},[e._v(" 展开 "),o("i",{staticClass:"el-icon-arrow-down"})]):e._e(),!0===e.open?o("el-button",{attrs:{type:"text"},on:{click:function(t){e.open=!1}}},[e._v(" 收起 "),o("i",{staticClass:"el-icon-arrow-up"})]):e._e()]:e._e()],2)])},s=[],a=(o("4160"),o("159b"),o("2422")),i=o("8604"),n={input:{placeholder:"请输入"},select:{placeholder:"请选择",clearable:!0},date:{placeholder:"选择日期",valueFormat:"timestamp",type:"date"},dateRange:{placeholder:"选择日期",valueFormat:"timestamp",type:"daterange",rangeSeparator:"至",startPlaceholder:"开始日期",endPlaceholder:"结束日期"}},l={name:"tableSearch",components:{FormSelect:a["a"],FormOrganize:i["a"]},props:{value:{},columns:{type:Array},resettable:{type:Boolean,default:!1},labelWidth:{type:String,default:"80px"}},directives:{resize:{bind:function(e,t){var o="",r="";function s(){var s=document.defaultView.getComputedStyle(e);o===s.width&&r===s.height||t.value(),o=s.width,r=s.height}e.__vueSetInterval__=setInterval(s,100)},unbind:function(e){clearInterval(e.__vueSetInterval__)}}},data:function(){return{defaultForm:{},form:{},showOpen:!1,open:!1}},watch:{value:{deep:!0,handler:function(e){this.form=Object.assign(this.form,e)}},columns:{deep:!0,handler:function(){this.resetForm()}},form:{deep:!0,handler:function(){this.$emit("input",this.form)}},open:function(){this.setHeight()}},created:function(){this.resetForm(),this.defaultForm=Object.assign({},this.form)},mounted:function(){this.$emit("input",this.form)},methods:{resetForm:function(){var e={};this.columns&&this.columns.length&&this.columns.forEach((function(t){t.props||(t.props={}),n[t.type]||(n[t.type]={}),t.props=Object.assign(t.props,n[t.type]),e[t.prop]=""})),this.form=Object.assign(e,this.value)},formResize:function(){this.$refs["form-box"]&&this.$refs["form-box"].clientHeight>60?(this.showOpen=!0,this.setHeight()):this.showOpen=!1},setHeight:function(){this.$refs["search-form"].style.height=this.open?this.$refs["form-box"].clientHeight+"px":"40px"},reset:function(){this.form=Object.assign({},this.defaultForm),this.$emit("reset",this.form)},search:function(){this.$emit("search",this.form)}}},c=l,u=(o("c41a"),o("2877")),m=Object(u["a"])(c,r,s,!1,null,"c04e5e04",null);t["a"]=m.exports},af68:function(e,t,o){},c41a:function(e,t,o){"use strict";o("af68")},d1e0:function(e,t,o){},d484:function(e,t,o){"use strict";o("d1e0")}}]);
//# sourceMappingURL=chunk-2b4c85ac.8e575ff6.js.map