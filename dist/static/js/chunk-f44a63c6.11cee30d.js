(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f44a63c6"],{6208:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table-search"},[a("div",{directives:[{name:"resize",rawName:"v-resize",value:e.formResize,expression:"formResize"}],ref:"search-form",staticClass:"search-form"},[a("div",{ref:"form-box"},[e._t("default",[a("el-form",{ref:"form",attrs:{model:e.form,inline:!0,"label-width":e.labelWidth}},[e._l(e.columns,(function(t,o){return a("el-form-item",{key:o,attrs:{label:t.label,"label-width":t.labelWidth}},["org"===t.type?a("form-organize",{model:{value:e.form[t.prop],callback:function(a){e.$set(e.form,t.prop,a)},expression:"form[column.prop]"}}):"input"===t.type?a("el-input",e._b({staticClass:"short-width",model:{value:e.form[t.prop],callback:function(a){e.$set(e.form,t.prop,a)},expression:"form[column.prop]"}},"el-input",t.props,!1)):"select"===t.type?a("form-select",e._b({staticClass:"search-select-item",attrs:{options:t.options},model:{value:e.form[t.prop],callback:function(a){e.$set(e.form,t.prop,a)},expression:"form[column.prop]"}},"form-select",t.props,!1)):"date"===t.type||"dateRange"===t.type?a("el-date-picker",e._b({style:{width:"date"===t.type?"215px":""},model:{value:e.form[t.prop],callback:function(a){e.$set(e.form,t.prop,a)},expression:"form[column.prop]"}},"el-date-picker",t.props,!1)):e._t(t.prop,null,{form:e.form})],2)})),e._t("default")],2)])],2)]),a("div",{staticClass:"search-btn"},[e._t("search-btn",[a("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("查 询")]),e.resettable?a("el-button",{on:{click:e.reset}},[e._v("重 置")]):e._e()]),e.showOpen?[!1===e.open?a("el-button",{attrs:{type:"text"},on:{click:function(t){e.open=!0}}},[e._v(" 展开 "),a("i",{staticClass:"el-icon-arrow-down"})]):e._e(),!0===e.open?a("el-button",{attrs:{type:"text"},on:{click:function(t){e.open=!1}}},[e._v(" 收起 "),a("i",{staticClass:"el-icon-arrow-up"})]):e._e()]:e._e()],2)])},n=[],i=(a("4160"),a("159b"),a("2422")),s=a("8604"),r={input:{placeholder:"请输入"},select:{placeholder:"请选择",clearable:!0},date:{placeholder:"选择日期",valueFormat:"timestamp",type:"date"},dateRange:{placeholder:"选择日期",valueFormat:"timestamp",type:"daterange",rangeSeparator:"至",startPlaceholder:"开始日期",endPlaceholder:"结束日期"}},c={name:"tableSearch",components:{FormSelect:i["a"],FormOrganize:s["a"]},props:{value:{},columns:{type:Array},resettable:{type:Boolean,default:!1},labelWidth:{type:String,default:"80px"}},directives:{resize:{bind:function(e,t){var a="",o="";function n(){var n=document.defaultView.getComputedStyle(e);a===n.width&&o===n.height||t.value(),a=n.width,o=n.height}e.__vueSetInterval__=setInterval(n,100)},unbind:function(e){clearInterval(e.__vueSetInterval__)}}},data:function(){return{defaultForm:{},form:{},showOpen:!1,open:!1}},watch:{value:{deep:!0,handler:function(e){this.form=Object.assign(this.form,e)}},columns:{deep:!0,handler:function(){this.resetForm()}},form:{deep:!0,handler:function(){this.$emit("input",this.form)}},open:function(){this.setHeight()}},created:function(){this.resetForm(),this.defaultForm=Object.assign({},this.form)},mounted:function(){this.$emit("input",this.form)},methods:{resetForm:function(){var e={};this.columns&&this.columns.length&&this.columns.forEach((function(t){t.props||(t.props={}),r[t.type]||(r[t.type]={}),t.props=Object.assign(t.props,r[t.type]),e[t.prop]=""})),this.form=Object.assign(e,this.value)},formResize:function(){this.$refs["form-box"]&&this.$refs["form-box"].clientHeight>60?(this.showOpen=!0,this.setHeight()):this.showOpen=!1},setHeight:function(){this.$refs["search-form"].style.height=this.open?this.$refs["form-box"].clientHeight+"px":"40px"},reset:function(){this.form=Object.assign({},this.defaultForm),this.$emit("reset",this.form)},search:function(){this.$emit("search",this.form)}}},l=c,u=(a("c41a"),a("2877")),m=Object(u["a"])(l,o,n,!1,null,"c04e5e04",null);t["a"]=m.exports},"6cde":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tabs-box"},[a("common-table",{ref:"table",attrs:{headers:e.headers,api:e.pageAPI,selection:"",params:e.params,"can-add":!1,"can-delete-batch":!1,deleteApi:e.deleteAPI,uploadURL:e.uploadURL,modelUrl:e.modelUrl,settings:["setting","upload"]},on:{editRow:e.editRow,uploadComplete:e.uploadComplete},scopedSlots:e._u([{key:"table-header",fn:function(){return[a("table-search",{attrs:{resettable:"",labelWidth:"90px",columns:e.searchColumns},on:{search:e.search},model:{value:e.params,callback:function(t){e.params=t},expression:"params"}})]},proxy:!0},{key:"table-select-box",fn:function(t){var o=t.selects;return[o.length>0?a("span",{on:{click:function(t){return e.submitBatch(o)}}},[e._v("批量提交")]):e._e()]}}])}),e.visibleDialog?a("edit-dialog",{attrs:{visibleDialog:e.visibleDialog,title:e.title,columns:e.columns,loading:e.loading,form:e.form},on:{"update:visibleDialog":function(t){e.visibleDialog=t},"update:visible-dialog":function(t){e.visibleDialog=t},formUpdate:e.formUpdate,save:e.submit},scopedSlots:e._u([{key:"caseAddress",fn:function(t){var o=t.form;return[a("span",{staticStyle:{display:"inline-block","margin-right":"10px"}},[e._v(" 上海市 上海市 闵行区 ")]),a("el-input",{staticClass:"short-width",attrs:{placeholder:"请输入案件地址"},model:{value:o.caseAddress,callback:function(t){e.$set(o,"caseAddress",t)},expression:"form.caseAddress"}})]}}],null,!1,2129069083)}):e._e(),a("detail-dialog",{attrs:{title:"错误数据信息明细",visibleDialog:e.showError},on:{"update:visibleDialog":function(t){e.showError=t},"update:visible-dialog":function(t){e.showError=t}},scopedSlots:e._u([{key:"detail-content",fn:function(){return[a("div",{staticStyle:{"max-height":"600px",overflow:"auto"}},[a("ul",e._l(e.errorList,(function(t,o){return a("li",{key:o,staticStyle:{"margin-bottom":"4px"}},[e._v(e._s(t.errorMessage))])})),0)])]},proxy:!0}])})],1)},n=[],i=(a("99af"),a("4160"),a("d81d"),a("b0c0"),a("d3b7"),a("ac1f"),a("841c"),a("159b"),a("2909")),s=(a("96cf"),a("1da1")),r=a("1892"),c=a("ddde"),l=a("7713"),u=a("6208"),m=a("79b1"),p=a("afaa"),d=function(e){return Object(p["a"])({url:"/api-customer/community/caseManagementMatch/page",method:"GET",params:e})},h=function(e){return Object(p["a"])({method:"PUT",url:"/api-customer/community/caseManagementMatch/update",data:e})},f=function(e){return Object(p["a"])({method:"DELETE",url:"/api-customer/community/caseManagementMatch/delete?id=".concat(e.id)})},b=function(e){return Object(p["a"])({method:"POST",url:"/api-customer/community/caseManagementMatch/commit",data:e})},g=a("e419"),y=a("ed08"),v={name:"Case",components:{CommonTable:r["a"],EditDialog:c["a"],DetailDialog:l["a"],TableSearch:u["a"]},data:function(){return{pageAPI:d,deleteAPI:f,visibleDialog:!1,showError:!1,loading:!1,type:"add",title:"新增案件",modelUrl:"",uploadURL:"/api-customer/community/caseManagementMatch/import",case:[],params:{},errorList:[],dimensionTree:[],headers:[{prop:"index",label:"序号"},{prop:"caseNumber",label:"接警单编号"},{prop:"caseDimensionName",label:"案件维度"},{prop:"caseReasonName",label:"一级案由"},{prop:"subCaseReasonName",label:"二级案由"},{prop:"caseTime",label:"报案时间",type:"date"},{prop:"match",label:"匹配结果",filter:function(e){return e?"有结果":"无结果"}},{prop:"communityTypeName",label:"社区类型"},{prop:"communityName",label:"社区名称"},{prop:"action",label:"操作",width:100,fixed:"right"}],commonOptions:{communityTypes:[],communities:[]},searchOptions:{caseDimensions:[],caseReasons:[],subCaseReasons:[]},form:{},formData:{}}},computed:{searchColumns:function(){return[{prop:"caseNumber",label:"接警单编号",type:"input"},{prop:"caseDimension",label:"案件维度",type:"select",options:this.searchOptions.caseDimensions},{prop:"caseReasonId",label:"一级案由",type:"select",options:this.searchOptions.caseReasons},{prop:"subCaseReasonId",label:"二级案由",type:"select",options:this.searchOptions.subCaseReasons},{prop:"communityId",label:"社区名称",type:"select",options:this.commonOptions.communities}]},columns:function(){return[{prop:"communityTypeId",label:"社区类型",type:"select",required:!0,options:this.commonOptions.communityTypes},{prop:"communityId",label:"社区名称",type:"select",required:!0,options:this.commonOptions.communities}]}},watch:{"params.caseDimension":function(e){this.dimensionChange(e)},"params.caseReasonId":function(e){this.caseReasonChange(e)},"formData.communityTypeId":function(e,t){this.getCommunities(e,t)}},created:function(){this.getOptions();var e=this.$store.state.auth.token;this.modelUrl="/api-customer/community/caseManagementMatch/downloadTemplate?token=".concat(e)},methods:{getOptions:function(){this.getTypes(),this.getCaseDimensions(),this.getCommunities()},getTypes:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(y["d"])("COMMUNITY_TYPE");case 2:e.commonOptions.communityTypes=t.sent;case 3:case"end":return t.stop()}}),t)})))()},getCaseDimensions:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(m["d"])();case 2:e.dimensionTree=t.sent,e.searchOptions.caseDimensions=(e.dimensionTree||[]).map((function(e){return{id:e.code,name:e.name}}));case 4:case"end":return t.stop()}}),t)})))()},getCommunities:function(e,t){var a=this;return Object(s["a"])(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return t&&(a.formData.communityId=""),o.next=3,Object(g["c"])({type:e});case 3:a.commonOptions.communities=o.sent;case 4:case"end":return o.stop()}}),o)})))()},search:function(){this.$refs.table.onQuery()},uploadComplete:function(e){e.data&&e.data.length&&(this.$message.error("导入失败!"),this.errorList=e.data,this.showError=!0)},editRow:function(e){this.type="edit",this.title="编辑案件匹配",this.formData={},this.form=Object.assign({},e),this.visibleDialog=!0},submit:function(e){var t=this,a={id:e.id,communityTypeId:e.communityTypeId,communityId:e.communityId,communityName:this.getNameById(e.communityId,this.commonOptions.communities)};this.checkForm(a)&&(this.loading=!0,h(a).then((function(){t.$message.success("".concat(t.title,"成功！")),t.visibleDialog=!1,t.$refs.table.refresh()})).catch((function(e){t.$message.error("".concat(t.title,"失败：").concat(e))})).finally((function(){t.loading=!1})))},submitBatch:function(e){var t=this;this.$confirm("确定要提交至案件管理？").then((function(){b(e).then((function(e){e>0?t.$message.success("本次提交成功".concat(e,"条！")):t.$message.error("本次提交成功".concat(e,"条！")),t.search()})).catch((function(e){t.$message.error("提交失败："+e)}))}))},checkForm:function(e){if(e)return!0},formUpdate:function(e){this.formData=e},dimensionChange:function(e){this.params.caseReasonId="",this.params.subCaseReasonId="",this.searchOptions.caseReasons=this.getTreeChildByCode(e,1)},caseReasonChange:function(e){this.params.subCaseReasonId="",this.searchOptions.subCaseReasons=this.getTreeChildByCode(e,2)},getTreeChildByCode:function(e,t){if(!e&&0!==e)return[];var a=[];switch(t){case 1:a=this.dimensionTree;break;case 2:(this.dimensionTree||[]).forEach((function(e){var t;(t=a).push.apply(t,Object(i["a"])(e.child||[]))}));break}var o=[];return a.forEach((function(t){e===t.code&&(o=(t.child||[]).map((function(e){return{id:e.code,name:e.name}})))})),o},getNameById:function(e,t){var a="--";return t.forEach((function(t){t.id===e&&(a=t.name)})),a}}},w=v,O=a("2877"),_=Object(O["a"])(w,o,n,!1,null,null,null);t["default"]=_.exports},7713:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{"custom-class":"table-edit-dialog",title:e.title,width:e.width,top:e.top,fullscreen:e.fullscreen,"append-to-body":e.appendToBody,"close-on-click-modal":!1,visible:e.visibleDialog,"before-close":e.closeDialog},on:{"update:visible":function(t){e.visibleDialog=t}}},[a("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[e._t("dialog-header",[e._v(e._s(e.title))]),a("i",{staticClass:"screen-icon el-icon-full-screen",on:{click:function(t){t.stopPropagation(),e.fullscreen=!e.fullscreen}}})],2),e._t("detail-header"),e._t("detail-content",[a("div",{staticClass:"common-table"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"max-height":e.maxTableHeight,border:""},on:{"selection-change":e.handleSelectionChange}},[e.selection?a("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),e._l(e.headers,(function(t,o){return["index"===t.prop?a("el-table-column",{key:o,attrs:{type:t.prop,width:t.width?t.width:50,label:t.label||"序号"}}):a("el-table-column",{key:o,attrs:{align:"left",width:t.width?t.width:"auto",type:"index"===t.prop?"index":"","show-overflow-tooltip":"",prop:t.prop,sortable:t.sortable,fixed:t.fixed,label:t.label},scopedSlots:e._u([{key:"default",fn:function(o){return[e._t(t.prop,[a("span",{class:t.copiable?"copiable":""},[e._v(e._s(o.row[t.prop]))])],{row:o.row})]}}],null,!0)})]}))],2)],1),e.page.totalCount>e.page.pageSize?a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, jumper","page-size":e.page.pageSize,"current-page":e.page.currentPage,"prev-text":"上一页","next-text":"下一页",total:e.page.totalCount},on:{"current-change":function(t){return e.changePage(t,!0)}}}):e._e()]),e._t("detail-footer"),e.showFooter?a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e._t("form-action")],2):e._e()],2)},n=[],i=(a("797d"),{name:"detailDialog",props:{width:{type:String,default:"80%"},top:{type:String,default:"10vh"},maxTableHeight:{},visibleDialog:{type:Boolean,default:!1},title:{type:String,default:"信息明细"},selection:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},appendToBody:{type:Boolean,default:!1},showFooter:{type:Boolean,default:!1},data:{default:function(){return[]}},headers:{type:Array},page:{type:Object,default:function(){return{pageSize:10,totalCount:0,currentPage:1}}}},data:function(){return{fullscreen:!1,tableData:[],selects:[]}},watch:{data:function(e){this.tableData=e.data||e}},created:function(){this.tableData=this.data.data||this.data||[]},mounted:function(){this.fullscreen=document.body.clientWidth<800},deactivated:function(){this.visibleDialog&&this.closeDialog()},methods:{changePage:function(e){this.$emit("changePage",e)},handleSelectionChange:function(e){this.selects=e},closeDialog:function(){this.$emit("update:visibleDialog",!1)}}}),s=i,r=a("2877"),c=Object(r["a"])(s,o,n,!1,null,null,null);t["a"]=c.exports},"79b1":function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return i})),a.d(t,"e",(function(){return s})),a.d(t,"b",(function(){return r})),a.d(t,"d",(function(){return c}));var o=a("afaa"),n=function(e){return Object(o["a"])({url:"/api-customer/community/case/list",method:"GET",params:e})},i=function(e){return Object(o["a"])({method:"POST",url:"/api-customer/community/case/add",data:e})},s=function(e){return Object(o["a"])({method:"PUT",url:"/api-customer/community/case/update",data:e})},r=function(e){return Object(o["a"])({method:"DELETE",url:"/api-customer/community/case/delete?id=".concat(e.id)})},c=function(e){return Object(o["a"])({method:"GET",url:"/api-customer/community/queryCaseDimensions/cascade",params:e})}},af68:function(e,t,a){},c41a:function(e,t,a){"use strict";a("af68")},e419:function(e,t,a){"use strict";a.d(t,"d",(function(){return n})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return s})),a.d(t,"f",(function(){return r})),a.d(t,"b",(function(){return c})),a.d(t,"e",(function(){return l}));var o=a("afaa"),n=function(e){return Object(o["a"])({url:"/api-customer/service-wisdom-town/community/list",method:"GET",params:e})},i=function(e){return Object(o["a"])({url:"/api-customer/service-wisdom-town/community/getAll",method:"GET",params:e})},s=function(e){return Object(o["a"])({method:"POST",url:"/api-customer/service-wisdom-town/community/insert",data:e})},r=function(e){return Object(o["a"])({method:"PUT",url:"/api-customer/service-wisdom-town/community/update",data:e})},c=function(e){return Object(o["a"])({method:"DELETE",url:"/api-customer/service-wisdom-town/community/delete?id=".concat(e.id)})},l=function(e){return Object(o["a"])({url:"/api-customer/service-wisdom-town/community/queryPolice",method:"GET",params:e})}}}]);
//# sourceMappingURL=chunk-f44a63c6.11cee30d.js.map