{"version":3,"sources":["webpack:///./src/views/organize/organize.vue?f1d1","webpack:///./src/api/common/index.js","webpack:///src/views/organize/organize.vue","webpack:///./src/views/organize/organize.vue?afd5","webpack:///./src/views/organize/organize.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","staticStyle","ref","attrs","options","on","getSelect","_e","headers","orgData","editRow","deleteComplete","scopedSlots","_u","key","fn","add","_v","proxy","columns","form","editOptions","visibleDialog","title","$event","save","staticRenderFns","reloadToken","data","http","url","method","name","components","type","activeName","parent","labelWidth","created","loadData","methods","getChildren","val","id","i","pId","sub_organizationDto","result","row","saveAPI","saveForm","component"],"mappings":"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","file":"static/js/chunk-2d0e6875.3b3cbeb7.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"tabs-box\"},[_c('div',{staticStyle:{\"display\":\"flex\"}},[_c('div',{staticStyle:{\"width\":\"300px\"}},[(_vm.options)?_c('tide-combination',{ref:\"tideCombination\",attrs:{\"showCheckbox\":false,\"nodeKey\":\"id\",\"expandAll\":true,\"options\":_vm.options,\"children\":\"sub_organizationDto\"},on:{\"export\":_vm.getSelect}}):_vm._e()],1),_c('div',{staticStyle:{\"padding-left\":\"20px\",\"margin-left\":\"20px\",\"flex\":\"1\",\"border-left\":\"1px solid #eee\"}},[_c('common-table',{ref:\"table\",attrs:{\"headers\":_vm.headers,\"data\":_vm.orgData,\"canDelete\":false},on:{\"editRow\":_vm.editRow,\"deleteComplete\":_vm.deleteComplete},scopedSlots:_vm._u([{key:\"header-left\",fn:function(){return [_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":_vm.add}},[_c('i',{staticClass:\"el-icon-plus\"}),_vm._v(\"新增下级 \")])]},proxy:true}])})],1)]),(_vm.visibleDialog)?_c('edit-dialog',{attrs:{\"columns\":_vm.columns,\"form\":_vm.form,\"options\":_vm.editOptions,\"visibleDialog\":_vm.visibleDialog,\"title\":_vm.title},on:{\"update:visibleDialog\":function($event){_vm.visibleDialog=$event},\"update:visible-dialog\":function($event){_vm.visibleDialog=$event},\"save\":_vm.save}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import http from \"@/server/http.js\";\r\n\r\n// 组织机构或组织机构权限更新时更新token关联内容\r\nexport const reloadToken = data => {\r\n  return http({\r\n    url: `/api-customer/user/reloadToken`,\r\n    method: \"post\",\r\n    data\r\n  });\r\n};\r\n","<template>\r\n  <div class=\"tabs-box\">\r\n    <!--<el-tabs v-model=\"activeName\">\r\n      <el-tab-pane\r\n        name=\"organization\"\r\n        @click.native=\"activeName = 'organization'\"\r\n      >\r\n        <span slot=\"label\" style=\"padding: 0 6px\">组织架构</span>\r\n\r\n      </el-tab-pane>\r\n    </el-tabs>-->\r\n    <div style=\"display: flex\">\r\n      <div style=\"width: 300px\">\r\n        <tide-combination\r\n          v-if=\"options\"\r\n          :showCheckbox=\"false\"\r\n          nodeKey=\"id\"\r\n          :expandAll=\"true\"\r\n          @export=\"getSelect\"\r\n          ref=\"tideCombination\"\r\n          :options=\"options\"\r\n          children=\"sub_organizationDto\"\r\n        ></tide-combination>\r\n      </div>\r\n      <div\r\n        style=\"padding-left: 20px;margin-left: 20px;flex: 1;border-left: 1px solid #eee\"\r\n      >\r\n        <common-table\r\n          ref=\"table\"\r\n          :headers=\"headers\"\r\n          :data=\"orgData\"\r\n          :canDelete=\"false\"\r\n          @editRow=\"editRow\"\r\n          @deleteComplete=\"deleteComplete\"\r\n        >\r\n          <template v-slot:header-left>\r\n            <el-button type=\"primary\" size=\"small\" @click=\"add\">\r\n              <i class=\"el-icon-plus\"></i>新增下级\r\n            </el-button>\r\n          </template>\r\n        </common-table>\r\n      </div>\r\n    </div>\r\n    <edit-dialog\r\n      v-if=\"visibleDialog\"\r\n      :columns=\"columns\"\r\n      :form=\"form\"\r\n      :options=\"editOptions\"\r\n      :visibleDialog.sync=\"visibleDialog\"\r\n      :title=\"title\"\r\n      @save=\"save\"\r\n    ></edit-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport CommonTable from \"@/components/commonTable/table.vue\";\r\nimport EditDialog from \"@/components/commonTable/editDialog.vue\";\r\nimport TideCombination from \"@/components/combination/index.vue\";\r\n\r\nimport { reloadToken } from \"@/api/common/index\";\r\n\r\nimport {\r\n  orgAddAPI,\r\n  orgUpdateAPI,\r\n  getAllOrgSettingAPI\r\n} from \"@/api/organize/index\";\r\n\r\nexport default {\r\n  name: \"Organize\",\r\n  components: { CommonTable, EditDialog, TideCombination },\r\n  data() {\r\n    return {\r\n      type: \"add\",\r\n      activeName: \"organization\",\r\n      title: \"新增组织机构\",\r\n      visibleDialog: false,\r\n      options: null,\r\n      orgData: [],\r\n      parent: null,\r\n      form: {},\r\n      editOptions: {\r\n        labelWidth: \"120px\"\r\n      },\r\n      headers: [\r\n        { prop: \"index\", label: \"序号\" },\r\n        { prop: \"name\", label: \"组织机构名称\" },\r\n        { prop: \"action\", label: \"操作\", width: \"100px\", fixed: \"right\" }\r\n      ],\r\n      columns: [\r\n        {\r\n          prop: \"pId\",\r\n          label: \"上级组织机构：\",\r\n          type: \"select\",\r\n          options: [],\r\n          props: { disabled: true }\r\n        },\r\n        { prop: \"name\", label: \"名称：\", type: \"text\", required: true }\r\n      ]\r\n    };\r\n  },\r\n  created() {\r\n    this.loadData();\r\n  },\r\n  methods: {\r\n    loadData() {\r\n      getAllOrgSettingAPI().then(res => {\r\n        this.options = [res];\r\n        if (!this.parent) {\r\n          this.parent = this.options[0];\r\n        }\r\n        this.getSelect([this.parent]);\r\n      });\r\n    },\r\n    getSelect(val) {\r\n      this.orgData = this.getChildren(val[0].id, this.options) || [];\r\n      this.columns[0].options = val;\r\n      this.parent = val[0];\r\n    },\r\n    getChildren(pId, options) {\r\n      for (let i = 0; i < options.length; i++) {\r\n        if (options[i].id === pId) {\r\n          return options[i].sub_organizationDto || [];\r\n        }\r\n        if (options[i].sub_organizationDto) {\r\n          let result = this.getChildren(pId, options[i].sub_organizationDto);\r\n          if (result) {\r\n            return result;\r\n          }\r\n        }\r\n      }\r\n    },\r\n    editRow(row) {\r\n      this.form = row;\r\n      this.type = \"edit\";\r\n      this.title = \"编辑组织机构\";\r\n      this.visibleDialog = true;\r\n    },\r\n    add() {\r\n      this.form = {};\r\n      this.type = \"add\";\r\n      this.title = \"新增组织机构\";\r\n      this.form.pId = this.parent.id;\r\n      this.visibleDialog = true;\r\n    },\r\n    save(v) {\r\n      let saveAPI = this.type === \"add\" ? orgAddAPI : orgUpdateAPI;\r\n      let saveForm = Object.assign({}, v);\r\n      saveAPI(saveForm)\r\n        .then(() => {\r\n          this.$message.success(`${this.title}成功`);\r\n          this.visibleDialog = false;\r\n          this.loadData();\r\n          reloadToken([]).finally(() => {\r\n            this.$store.dispatch(\"setBaseOrgList\");\r\n          });\r\n        })\r\n        .catch(message => {\r\n          this.$message.error(`${this.title}失败：${message}`);\r\n        });\r\n    },\r\n    deleteComplete() {\r\n      this.loadData();\r\n    }\r\n  }\r\n};\r\n</script>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./organize.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./organize.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./organize.vue?vue&type=template&id=932a8b8a&\"\nimport script from \"./organize.vue?vue&type=script&lang=js&\"\nexport * from \"./organize.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}